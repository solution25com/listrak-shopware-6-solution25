"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[84437],{437:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});class i{static iterate(e,t){if(e instanceof Map||Array.isArray(e))return e.forEach(t);if(e instanceof FormData){for(var s of e.entries())t(s[1],s[0]);return}if(e instanceof NodeList)return e.forEach(t);if(e instanceof HTMLCollection)return Array.from(e).forEach(t);if(e instanceof Object)return Object.keys(e).forEach(s=>{t(e[s],s)});throw Error("The element type ".concat(typeof e," is not iterable!"))}}let r="loader",o={BEFORE:"before",INNER:"inner"};class n{create(){if(!this.exists()){if(this.position===o.INNER){this.parent.innerHTML=n.getTemplate();return}this.parent.insertAdjacentHTML(this._getPosition(),n.getTemplate())}}remove(){let e=this.parent.querySelectorAll(".".concat(r));i.iterate(e,e=>e.remove())}exists(){return this.parent.querySelectorAll(".".concat(r)).length>0}_getPosition(){return this.position===o.BEFORE?"afterbegin":"beforeend"}static getTemplate(){return'<div class="'.concat(r,'" role="status">\n                    <span class="').concat("visually-hidden",'">Loading...</span>\n                </div>')}static SELECTOR_CLASS(){return r}constructor(e,t=o.BEFORE){this.parent=e instanceof Element?e:document.body.querySelector(e),this.position=t}}class a{static isTouchDevice(){return"ontouchstart"in document.documentElement}static isIOSDevice(){return a.isIPhoneDevice()||a.isIPadDevice()}static isNativeWindowsBrowser(){return a.isIEBrowser()||a.isEdgeBrowser()}static isIPhoneDevice(){return!!navigator.userAgent.match(/iPhone/i)}static isIPadDevice(){return!!navigator.userAgent.match(/iPad/i)}static isIEBrowser(){return -1!==navigator.userAgent.toLowerCase().indexOf("msie")||!!navigator.userAgent.match(/Trident.*rv:\d+\./)}static isEdgeBrowser(){return!!navigator.userAgent.match(/Edge\/\d+/i)}static getList(){return{"is-touch":a.isTouchDevice(),"is-ios":a.isIOSDevice(),"is-native-windows":a.isNativeWindowsBrowser(),"is-iphone":a.isIPhoneDevice(),"is-ipad":a.isIPadDevice(),"is-ie":a.isIEBrowser(),"is-edge":a.isEdgeBrowser()}}}let c="modal-backdrop",u="modal-backdrop-open",l="no-scroll",d={ON_CLICK:"backdrop/onclick"};class h{create(e){this._removeExistingBackdrops(),document.body.insertAdjacentHTML("beforeend",this._getTemplate());let t=document.body.lastChild;document.documentElement.classList.add(l),setTimeout(function(){t.classList.add(u),"function"==typeof e&&e()},75),this._dispatchEvents()}remove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:350,t=this._getBackdrops();i.iterate(t,e=>e.classList.remove(u)),setTimeout(this._removeExistingBackdrops.bind(this),e),document.documentElement.classList.remove(l)}_dispatchEvents(){let e=a.isTouchDevice()?"touchstart":"click";document.addEventListener(e,function(e){e.target.classList.contains(c)&&document.dispatchEvent(new CustomEvent(d.ON_CLICK))})}_getBackdrops(){return document.querySelectorAll(".".concat(c))}_removeExistingBackdrops(){if(!1===this._exists())return;let e=this._getBackdrops();i.iterate(e,e=>e.remove())}_exists(){return document.querySelectorAll(".".concat(c)).length>0}_getTemplate(){return'<div class="'.concat(c,'"></div>')}constructor(){return h.instance||(h.instance=this),h.instance}}let m=Object.freeze(new h);class f{static create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;m.create(e)}static remove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:350;m.remove(e)}static SELECTOR_CLASS(){return c}}let v=Object.freeze(new class extends n{create(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];!this.exists()&&e&&(f.create(),document.querySelector(".".concat(f.SELECTOR_CLASS())).insertAdjacentHTML("beforeend",n.getTemplate()))}remove(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];super.remove(),e&&f.remove()}constructor(){super(document.body)}});class g{static create(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];v.create(e)}static remove(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];v.remove(e)}}class p{static serialize(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("FORM"!==e.nodeName){if(t)throw Error("The passed element is not a form!");return{}}return new FormData(e)}static serializeJson(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s=p.serialize(e,t);if(0===Object.keys(s).length)return{};let r={};return i.iterate(s,(e,t)=>r[t]=e),r}}let{PluginBaseClass:b}=window;class E extends b{init(){if(this.formSubmittedByCaptcha=!1,this._getForm(),!this._form)throw Error("No form found for the plugin: ".concat(this.constructor.name));if(this.options.useAjax&&!this.options.ajaxContainerSelector)throw Error("[".concat(this.constructor.name,'] The option "ajaxContainerSelector" must be given when using ajax.'));this._registerEvents(),this._resumeFocusState()}_registerEvents(){let e=this._onSubmit.bind(this);this._form.removeEventListener("change",e),this._form.addEventListener("change",e)}_getForm(){this._form=document.querySelector(".listrak-newsletter-form")}_onSubmit(e){e.preventDefault(),g.create(),this.$emitter.publish("beforeSubmit"),this._saveFocusState(e.target),this.formSubmittedByCaptcha||this.sendAjaxFormSubmit()}sendAjaxFormSubmit(){let e=p.serialize(this._form),t=this._form.getAttribute("action");fetch(t,{method:"POST",body:e,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>e.json()).then(e=>this._onAfterAjaxSubmit(e))}_onAfterAjaxSubmit(e){g.remove();let t=document.querySelector(this.options.ajaxContainerSelector),s=document.querySelector(this.options.newsletterCheckbox);s.value="subscribe"===s.value?"unsubscribe":"subscribe";let i="";e.forEach(e=>{i+=e.alert}),t.innerHTML=i,window.PluginManager.initializePlugins(),this.$emitter.publish("onAfterAjaxSubmit")}_saveFocusState(e){this.options.autoFocus&&window.focusHandler.saveFocusState(this.options.focusHandlerKey,'[data-focus-id="'.concat(e.dataset.focusId,'"]'))}_resumeFocusState(){this.options.autoFocus&&window.focusHandler.resumeFocusState(this.options.focusHandlerKey)}}E.options={ajaxContainerSelector:".js-listrak-newsletter-wrapper",newsletterCheckbox:"#listrakNewsletterRegister",autoFocus:!0,focusHandlerKey:"listrak-auto-submit",useAjax:!0}}}]);